<div class="restaurant-card" [class.closed]="!restaurant.isOpen">
  <div class="restaurant-image">
    <img [src]="restaurant.image" [alt]="restaurant.name">
    <div class="status-badge" *ngIf="!restaurant.isOpen">Cerrado</div>
    <div class="delivery-time">{{ restaurant.deliveryTime }}</div>
  </div>
  <div class="restaurant-info">
    <div class="restaurant-header">
      <h3 class="restaurant-name">{{ restaurant.name }}</h3>
      <div class="rating">
        <div class="stars">
          <span *ngFor="let star of getStarsArray()" class="star" [class.filled]="star <= restaurant.rating">⭐</span>
        </div>
        <span class="rating-number">({{ restaurant.rating }})</span>
      </div>
    </div>
    <p class="restaurant-description">{{ restaurant.description }}</p>
    <div class="restaurant-details">
      <div class="category-tag">{{ restaurant.category }}</div>
      <div class="delivery-info">
        <span class="delivery-fee">Domicilio: ${{ restaurant.deliveryFee | number }}</span>
      </div>
    </div>
    <div class="menu-preview" *ngIf="restaurant.menu.length > 0">
      <h4>Menú destacado:</h4>
      <div class="menu-items">
        <div class="menu-item" *ngFor="let item of restaurant.menu.slice(0, 2)">
          <span class="item-name">{{ item.name }}</span>
          <span class="item-price">${{ item.price | number }}</span>
        </div>
      </div>
    </div>
  <button class="order-btn" [disabled]="!restaurant.isOpen" (click)="openMenu()">{{ restaurant.isOpen ? 'Ver Menú' : 'Cerrado' }}</button>
</div>

<!-- Modales con *ngIf -->
<ng-container *ngIf="showMenuModal">
  <div class="modal-overlay">
    <div class="modal-backdrop" (click)="closeMenu()"></div>
    <div class="modal-container">
      <div class="modal-content">
        <div class="modal-header">
          <h3>Menú de {{ restaurant.name }}</h3>
          <button class="modal-close" (click)="closeMenu()">×</button>
        </div>
        <div class="modal-body">
          <ul class="menu-list">
            <li *ngFor="let item of restaurant.menu">
              <div class="menu-item-info">
                <span class="item-name">{{ item.name }}</span>
                <span class="item-price">${{ item.price | number }}</span>
              </div>
              <button class="add-to-cart" (click)="addToCart(item)">
                Agregar al carrito
              </button>
            </li>
          </ul>
        </div>
        <div class="modal-footer">
          <button class="cart-btn" (click)="openCart(); closeMenu()">Ver carrito</button>
          <button class="close-btn" (click)="closeMenu()">Cerrar</button>
        </div>
      </div>
    </div>
  </div>
</ng-container>

<ng-container *ngIf="showCartModal">
  <div class="modal-overlay">
    <div class="modal-backdrop" (click)="closeCart()"></div>
    <div class="modal-container">
      <div class="modal-content">
        <div class="modal-header">
          <h3>Tu Carrito</h3>
          <button class="modal-close" (click)="closeCart()">×</button>
        </div>
        <div class="modal-body">
          <ul class="menu-list">
            <li *ngFor="let item of cartService.items$ | async">
              <div class="menu-item-info">
                <span class="item-name">{{ item.name }}</span>
                <span class="item-price">${{ item.price | number }}</span>
              </div>
            </li>
          </ul>
          <div class="cart-total">
            Total a pagar: <span>${{ cartService.getTotal() | number }}</span>
          </div>
        </div>
        <div class="modal-footer">
          <button class="cart-btn" (click)="cartService.clearCart(); closeCart()">Comprar ahora</button>
          <button class="close-btn" (click)="closeCart()">Cerrar</button>
        </div>
      </div>
    </div>
  </div>
</ng-container>
